# Objective
To perform a GO enrichment of each cluster previously generated by Martinfrom OrthoInspector results. 
# Material and methods

> [!warning] How to write material and methods ?
> You don't need to put the code in the hardware and method, just describe it, specifying :
> - Where data and scripts are stored.
> - Versions of packages / programs used.
> - If data has been downloaded, where it came from and when it was downloaded. 
The annotated genomic data for *Strigamia Acuminata* are available at: `/enadisk/gstock/MetaInvert/martin/strigamia-acuminata.b2g.reformated.annot` 
Gene clusters to be analyzed can be found here: `/enadisk/maison/schoenstein/stage24/results/`

The GO enrichment script can be found here: `/enadisk/maison/morlon/stage/script/clusterprofiler_go_enrichment_analysis.R`

A R script (version 4.2.3) allows to perform a GO enrichment analysis for each cluster generated by Martin. It takes as input :
- The results of the Blast2GO tsv output file
- The list of genes in each previously generated cluster. 
The different steps of the script are:
1. GO.db (version 3.16.0) associates each GO term (of the Blast2GO output) with its ID. From the cluster of interest, it builds a vector of gene IDs to be used in the enrichment.
2. The *enricher* function of the clusterProfiler package (version 2.6.2) is then run to perform the analysis. Here, the p-value threshold was set to 0.05, the The Benjamini-Hochberg procedure was used for p-value adjustment, and the minimum and maximum size of annotated genes for testing was set to 1 and 1000 respectively
3. The result per cluster is saved as a pdf (for easy viewing), svg (for integration in e.g. .md) and as a .rds (in-depth results). It is done thanks to the packages ggplot2 (version 3.5.1) and cowplot (version 1.1.3). 
For the data manipulation. I have used the packages readr (2.1.5) and (dplyr 1.1.4) and the package stringr (1.5.1) for the text manipulation.

> [!question] Questions
> What does the Benjamini-Hochberg procedure do? What's the difference with FDR? Is it possible to plot with FDR?
> >[!note] 
> >- BH procedure is used to produce/control FDR (i.e.  guaranteeing FDR is controled at a given alpha level, here being 0.05) 
> >- The function can be ran with (pAdjustMethod = "fdr"), although according to the p.adjust help page "BH" and "fdr" are aliases for the same method (fdr was BH before, but after addition of another method BH was created and fdr redirects to BH for backwards compatibility). There is also the possibility to run the calculation without adjusting the p-value (pAdjustMethod = "none")

# Results
## Heatmap with annoted clusters (Stage Martin)
![[Go enrichment for non-model species-1.png|400]]

## Cluster A
![400](GO_analysis_strigamia_acuminata_cluster_A_page-0001.jpg)
The A cluster is comprised of highly conserved genes.
Thus gene linked to essential go_terms have a high count (over represented) and show significant enrichment.
## Cluster B
![400](GO_analysis_strigamia_acuminata_cluster_B_page-0001.jpg)
The B cluster is comprised of highly conserved genes except for diplopoda.

The analysis displays high count of terms linked to protein (de)phosphorylation, and significant enrichment for those terms as well as for the IV complex of the mitochondrial respiratory chain. This could be explained by the activity of diplopoda in soil nutrient cycles which could be associated with specific metabolism chain.
> [!warning] Missing reference
> Where do find the link between these GO terms and soil nutrient cycles ? -> Add reference(s)
> 
## Cluster C

![400](GO_analysis_strigamia_acuminata_cluster_C_page-0001.jpg)
See cluster C1 and C2 (divided).
> [!question] Questions
> What's the difference between C1 and C2 (i.e. what's the point of splitting it in two?)?
> >[!todo] Note 
> >C1 genes present in diplopoda, C2 genes not present in diplopoda
## Cluster C1
![400](GO_analysis_strigamia_acuminata_cluster_C1_page-0001.jpg)
The C1 cluster is comprised of genes mostly absent of hexapoda, crustacea, chilecerata and most insects, however, theses are present in diplopoda.

The analysis displays high count and significant enrichment of terms linked to oxidoreductase activity, monooxygenase activity, and iron/heme binding. Once again, this could be due to the metabolism of diplopoda and *Strigamia Acuminata* which is linked to soil nutrient cycles.
> [!warning] Missing reference
> Where do find the link between these GO terms and soil nutrient cycles ? -> Add reference(s)
> > [!todo] Note 
> >Dehydrogenase is a oxydoreductase (oxidise soil organic matter), DHA level is linked to soil depth (https://www.intechopen.com/chapters/40938). millipedes/diplopoda are found in various soil layers (from leaf litter to much deeper) --> link between GO terms, diplopoda and nutrient cycling (https://www.researchgate.net/publication/258908372_ORDINAL_ABUNDANCE_AND_RICHNESS_OF_MILLIPEDES_Arthropoda_Diplopoda_IN_A_SUBTROPICAL_WET_FOREST_IN_PUERTO_RICO)
## Cluster C2
![400](GO_analysis_strigamia_acuminata_cluster_C2_page-0001.jpg)
The C2 cluster is comprised of genes mostly absent of hexapoda, crustacea, chilecerata and most insects, and also diplopoda.
The analysis displays high count and significant enrichment for the methyltranferase activity term, this surrepresentation could be due to species-specific natural product methyltransferases (NPMTs) that have specific functions particular to *Strigamia Acuminata*.
> [!question] Questions
> Why only one GO term ? What is the size of the cluster ?
> > [!todo] Note 
> >Cluster size = 73
## Cluster D

NO SIGNIFICANT ENRICHMENT
> [!question] Questions
> Why no enrichment for this cluster ? What is the size of the cluster ?
> > [!todo] Note 
> >Cluster size = 597

## Cluster E
![400](GO_analysis_strigamia_acuminata_cluster_E_page-0001.jpg)
The E cluster is comprised of highly conserved genes for arthropods expect for diplopoda and some nematoda.
Enrichment of term related to DNA transcription regulation, apoptosis, protein dimirixation and phosphorylation.
## Cluster F
![400](GO_analysis_strigamia_acuminata_cluster_F_page-0001.jpg)
The F cluster is comprised of genes mostly absent of hexapoda, crustacea, chilecerata, diplopoda, and most insects.
Most significant enrichment terms are linked to GPRC activity/signaling pathway, inferring that *Strigamia acuminata* evolved specific CPRG genes. The same can be found for calcium ion binding genes.
## Cluster G
![[GO_analysis_strigamia_acuminata_cluster_G_page-0001 3.jpg|400]]
The F cluster is comprised of genes highly conserved in diplopoda only.
Enrichment of term related to membrane composition, hydrolase activity, serite-type endopeptidase activity, proteolysis and membrane transport.
## Cluster H
![[GO_analysis_strigamia_acuminata_cluster_H_page-0001 (1).jpg|400]]
The H cluster is comprised of genes mostly specific to Strigamia Acuminata (and conserved in very foe chilopoda).
Enrichement of terms related to membrane transport/signaling receptor/transporters, sodium channel activity and chitin binding 
> [!question] Questions
> Diploda are not present in this cluster, while chitin is. Don't they have the same chitin? 
> > [!todo] Note 
> >Maybe this could imply structural/protective/developmental adaptation specific to Strigamia Acuminata --> Functional analysis of these genes to determine role ? 
# Conclusion
> [!exemple] Exemple of conclusion
The GO enrichment analysis of _Strigamia acuminata_ gene clusters reveals distinct functional themes: Clusters A and E are enriched in conserved biological processes like protein phosphorylation and gene regulation. Clusters B and C show enrichment in metabolic functions linked to soil nutrient cycles. Cluster F indicates adaptations in signaling and calcium ion binding. Cluster H highlights species-specific adaptations related to membrane transport and chitin binding. Cluster D shows no significant enrichment. 



